Number.prototype.between=function(a,b){return this<a?a:this>b?b:+this},$.fn.scroll=function(a){a=a||{};var b=this[0],c=this,d=c.width(),e=c.height(),f=c.offset(),g=-e;c.children("img").each(function(){$(this).on("load",function(){g+=$(this).height()})});var h;a.bar&&(a.bar=$(a.bar).detach().appendTo("body"),h=a.bar.height(),a.bar.css({position:"absolute",left:f.left+d}).show());var k,n,p,q,i=a.elastic,j=!1,l=a.arrayFnSpaces,m=e-h,o=0,r=1,s=1,t=function(a){return isNaN(a.pageY)?(a=a.originalEvent,a=a.touches[0]||a.changedTouches[0],a.pageY):a.pageY},u=function(a){"function"==typeof a.stopPropagation&&a.stopPropagation(),o=t(a),n=b.scrollTop,c.on(v,w)},v="mousemove touchmove",w=function(d){q=new Date,p=o-t(d),c.scrollTop((n+p).between(0,g)),h&&a.bar.css({top:b.scrollTop/g*m+f.top}),j!==!1&&(s=j(b.scrollTop),s!==r&&(k(s),r=s))};w({pageY:0});var x=function(a){var b=p/3.5|0,d=20;c.off(v,w),!i||+new Date-+q>200||!function c(e,f){e&&setTimeout(function(){var d=t(a)-b*f;w({pageY:d}),c(e-1,f+1)},d)}(0|Math.sqrt(Math.abs(b)),1)};if("object"==typeof l&&l.map===[].map){var k=l[0];l.length&&"function"==typeof k&&(l[0]=0,l.push(1/0),j=function(a){for(var b=l.length,c=0;c<b;c++)if(a<l[c])return c;return b})}return c.on("mousedown touchstart",u).on("mouseup touchend",x),{moveToSpace:function(a){u({pageY:0});var c=b.scrollTop-l[a-1];w({pageY:c});var d=i;i=!1,x({pageY:c}),i=d}}};
