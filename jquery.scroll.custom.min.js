Number.prototype.between=function(a,b){return this<a?a:this>b?b:+this},$.fn.scroll=function(a){a=a||{};var b=this[0],c=this.css("overflow","hidden"),d=c.width(),e=c.height(),f=c.offset(),g=f.top,h=-e,i=$(a.bar);i.length&&(i.detach().appendTo("body"),i.css({position:"absolute",left:f.left+d}));var m,n,o,p,q,j=a.elastic,k=!1,l=e-i.height(),r=function(a,b,c){var d=+(b||new Date)-+a;return c?d/1e3:d},s=1,t=1,u=function(a){return isNaN(a.pageY)&&(a=a.originalEvent,a=a.touches[0]||a.changedTouches[0]),a.pageY},v=function(a){"function"==typeof a.preventDefault&&a.preventDefault(),"function"==typeof a.stopPropagation&&a.stopPropagation(),"function"==typeof a.stopImmediatePropagation&&a.stopImmediatePropagation()},w=function(a){v(a),n=u(a),m=b.scrollTop,p=new Date,c.on(B,D)},x=a.arrayFnSpaces||[function(){}],y=x[0],z=function(a,b){s=t,y(a,b)};x[0]=0,x.push(1/0);var A=x.length,k=function(a){for(var b=0;b<A;b++)if(a<x[b])return b;return A},B="mousemove touchmove",C=!1,D=function(a){C||(C=!0,window.requestAnimationFrame(function(){q=new Date,o=n-u(a),c.scrollTop((m+o).between(0,h)),i.css({top:b.scrollTop/h*l+g,display:"block"}),t=k(b.scrollTop),C=!1,t!==s&&z(t,s)}))},E=function(a){if(c.off(B,D),j&&r(q)<200){var b=r(p,null,"seconds");newTime=b.between(2,b),F(u(a),o/newTime,20)}},F=function(a,b,c){var d=new Date,e=0|Math.sqrt(0|Math.abs(b)),f=b/e;!function b(e,g){var h=r(p,d)<0;e&&!h&&setTimeout(function(){D({pageY:a-f*g}),b(e-1,g+1)},c)}(e,1)};c.on("mousedown touchstart",w).on("mouseup touchend",E).on("scroll mousewheel",v);var G={moveToSpace:function(a){w({pageY:0});var c=b.scrollTop-x[a-1];D({pageY:c});var d=j;j=!1,E({pageY:c}),j=d}},H=parseInt(a.initialSpace).between(1,A),I=c.children("img"),J=0;return I.each(function(){$(this).on("load",function(){$(this).css({position:"relative",float:"left"}),J++,h+=$(this).height(),J===I.length&&G.moveToSpace(H||1)})}),G};